<html>
<style>
  #loader {
    border: 16px solid #f3f3f3;
    /* Light grey */
    border-top: 16px solid #3498db;
    /* Blue */
    border-radius: 50%;
    width: 70px;
    height: 70px;
    animation: spin 2s linear infinite;
    margin-left: 130px;
    margin-top: 20px;
    display: none;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }

    100% {
      transform: rotate(360deg);
    }
  }
</style>

<body style="font-family: Arial, Helvetica, sans-serif; font-size: 22px;">
  <div style="display: grid">
    <div style="grid-column-start: 2;">
      <img style="margin-top: 80px;" src="./afteron.jpeg" width="400px" height="400px" />
      <div style="margin: 20px 0;">
        <audio controls src="./after-short.mp3">
        </audio>
        <img style="margin-left: 30px;" src="./q.svg" onClick="getNote()" width="50px" height="50px">

      </div>
      <div id="loader"></div>
      <div id="note" style="width: 400px;">

      </div>
    </div>
  </div>

  <script type="text/javascript">
    var elem = document.querySelector("audio");
    elem.addEventListener("pause", function (e) {
      fetch("http://localhost:3000/snippet",
        {
          method: "POST",
          body: JSON.stringify({ startTime: e.timeStamp })
        }

      ).then(console.log).catch(console.log)
    })

    function getNote() {
      const loader = document.getElementById("loader")
      loader.style.display = "block";
      fetch("http://localhost:3000/getNote").then(async function (data) {
        const res = await data.json()
        const note = document.getElementById("note")
        note.innerHTML = res.text
        loader.style.display = "none";
        return data.json()
      }).catch(console.log)
    }
  </script>

</body>

</html>